<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{fragment/fragment :: setBody(~{ :: body})}">
    <th:block th:fragment="body">

        <!-- Masthead-->
        <header class="masthead" style="height: 100%">
            <div class="container px-4 px-lg-5 h-75">
                <div class="row gx-4 gx-lg-5 h-50 align-items-center justify-content-center">
                    <div class="col-lg-8 col-xl-6 text-center">
                        <h3 class="text-white font-weight-bold">Let's Mo Gak Ko!</h3>
                        <hr class="divider" />
                    </div>
                </div>
                <div class="row gx-4 gx-lg-5 justify-content-center mb-5">
                    <div class="col-lg-6">
                        <form id="contactForm" data-sb-form-api-token="API_TOKEN">
                            <!-- Name input-->
                            <div class="form-floating mb-3">
                                <input class="form-control" id="email" type="email" placeholder="Enter your email..." />
                                <label for="email">Email</label>
                            </div>
                            <!-- Email address input-->
                            <div class="form-floating mb-3">
                                <input class="form-control" id="password" type="password" placeholder="8자 이상을 권장합니다." />
                                <label for="password">Password</label>
                            </div>
                            <div class="d-grid mb-3">
                                <button class="btn btn-primary btn-xl" id="loginButton" type="button">로그인</button>
                            </div>
                            <div class="d-grid mb-3">
                                <button class="btn btn-primary btn-xl" id="signUpButton" type="button">회원가입</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </header>

        <script th:inline="javascript">

            window.onload = () => {
                const loginButton = document.querySelector("#loginButton")
                const signUpButton = document.querySelector("#signUpButton")

                loginButton.addEventListener("click", login)
                signUpButton.addEventListener("click", () => {
                    location.href = "/signup"
                })

                function login() {
                    const email = document.querySelector("#email")
                    const password = document.querySelector("#password")

                    const loginInputs = {
                        "email" : email.value,
                        "password" : password.value,
                    }

                    callRestApi(loginEvent, "POST", "/api/member/login", loginInputs);
                }

                function loginEvent() {
                    try {
                        if (httpRequest.readyState === XMLHttpRequest.DONE) {
                            if (httpRequest.status === 200) {
                                window.location.href = "/"
                            } else {
                                alert(httpRequest.responseText);
                                return;
                            }
                        }
                    }
                    catch( e ) {
                        alert('Caught Exception: ' + e.description);
                    }
                }
            }

        </script>
    </th:block>
</th:block>
</html>